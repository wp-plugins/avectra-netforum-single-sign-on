<?php
namespace NetAuth; class RestrictPassword { public function __construct() { add_filter('show_password_fields', array($this, 'disable')); add_filter('allow_password_reset', array($this, 'disable')); add_filter('gettext', array($this, 'remove')); } public function disable() { if (is_admin()) { $sp020054 = wp_get_current_user(); $spf7500b = new \WP_User($sp020054->ID); return !empty($spf7500b->roles) && is_array($spf7500b->roles) && array_shift($spf7500b->roles) == 'administrator'; } return false; } public function remove($sp89316e) { return preg_replace('/lost your password\\??/is', '', $sp89316e); } }