<?php
namespace WP\Views; abstract class Form { protected $wp; protected function store() { $sp8e126e = $_POST[$this->page]; array_walk_recursive($sp8e126e, array($this, 'sanitize')); return add_option($this->page, $sp8e126e) || update_option($this->page, $sp8e126e); } protected function validate() { if (!isset($_POST[$this->page])) { return false; } $sp8e126e = $_POST[$this->page]; $this->wp = new \WP_Error(); foreach ($this->fields as $spff115a => $sp522919) { $spff115a = $this->toSlug($spff115a); foreach ($sp522919['fields'] as $sp98f863 => $spffd2cb) { $sp98f863 = $this->toSlug($sp98f863); if (isset($spffd2cb['required']) && $spffd2cb['required']) { if (!is_null($sp8e126e[$spff115a][$sp98f863]) && trim($sp8e126e[$spff115a][$sp98f863]) == '') { $this->wp->add($sp98f863, __($spffd2cb['title'] . ' cannot be left empty.')); continue; } } if (isset($spffd2cb['validate']) && !is_null($spffd2cb['validate'])) { if (!is_array($spffd2cb['validate'])) { continue; } if (!preg_match('/^' . current($spffd2cb['validate']) . '$/is', $sp8e126e[$spff115a][$sp98f863])) { $sp4e442f = end($spffd2cb['validate']) != '' ? end($spffd2cb['validate']) : 'must be valid characters.'; $this->wp->add($sp98f863, __($spffd2cb['title'] . ' ' . $sp4e442f)); continue; } } } } return sizeof($this->wp->get_error_codes()) <= 0; } protected function flash($sp303415 = false, $sp4e442f = null) { if ($sp303415) { return printf('<div id="message" class="%s"><p><strong>%s</strong></p><p>%s</p></div>', $sp303415 ? 'error' : 'updated', $sp303415 ? __('Uh oh!') : __('Yay!'), __(implode('<br>', $this->wp->get_error_messages()))); } return printf('<div id="message" class="%s"><p><strong>%s</strong></p><p>%s</p></div>', 'updated', 'Yay!', is_null($sp4e442f) ? __('Your request has been processed successfully.') : __($sp4e442f)); } protected function sanitize(&$sp55c5a4) { return $sp55c5a4 = trim(stripslashes(sanitize_text_field($sp55c5a4))); } }