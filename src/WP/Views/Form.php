<?php
namespace WP\Views; abstract class Form { protected $wp; protected function store() { $spdb7518 = $_POST[$this->page]; array_walk_recursive($spdb7518, array($this, 'sanitize')); return add_option($this->page, $spdb7518) || update_option($this->page, $spdb7518); } protected function validate() { if (!isset($_POST[$this->page])) { return false; } $spdb7518 = $_POST[$this->page]; $this->wp = new \WP_Error(); foreach ($this->fields as $spce072b => $sp2fffe5) { $spce072b = $this->toSlug($spce072b); foreach ($sp2fffe5['fields'] as $spf25e6c => $spcff854) { $spf25e6c = $this->toSlug($spf25e6c); if (isset($spcff854['required']) && $spcff854['required']) { if (!is_null($spdb7518[$spce072b][$spf25e6c]) && trim($spdb7518[$spce072b][$spf25e6c]) == '') { $this->wp->add($spf25e6c, __($spcff854['title'] . ' cannot be left empty.')); continue; } } if (isset($spcff854['validate']) && !is_null($spcff854['validate'])) { if (!is_array($spcff854['validate'])) { continue; } if (!preg_match('/^' . current($spcff854['validate']) . '$/is', $spdb7518[$spce072b][$spf25e6c])) { $sp90821a = end($spcff854['validate']) != '' ? end($spcff854['validate']) : 'must be valid characters.'; $this->wp->add($spf25e6c, __($spcff854['title'] . ' ' . $sp90821a)); continue; } } } } return sizeof($this->wp->get_error_codes()) <= 0; } protected function flash($sp19328a = false, $sp90821a = null) { if ($sp19328a) { return printf('<div id="message" class="%s"><p><strong>%s</strong></p><p>%s</p></div>', $sp19328a ? 'error' : 'updated', $sp19328a ? __('Uh oh!') : __('Yay!'), __(implode('<br>', $this->wp->get_error_messages()))); } return printf('<div id="message" class="%s"><p><strong>%s</strong></p><p>%s</p></div>', 'updated', 'Yay!', is_null($sp90821a) ? __('Your request has been processed successfully.') : __($sp90821a)); } protected function sanitize(&$sp89316e) { return $sp89316e = trim(stripslashes(sanitize_text_field($sp89316e))); } }